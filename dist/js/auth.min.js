"use strict";var RB=RB||{};RB.AUTH={usernameValidation:!1,passwordValidation:!1,init:function(){$(".reg-un").on("keyup",function(){var e=$(".reg-un").val();e.length>=2?RB.AUTH.isUsernameAvailable(e):($(".reg-message").empty(),$(".reg-icon").hide())}),$(".reg-pw-2").on("keyup",function(){RB.AUTH.comparePasswords()}),$(".register-form").on("keyup",function(e){13===e.keyCode&&$(".reg-submit .fa").hasClass("ready")&&RB.AUTH.registerLocalUser()})},isUsernameAvailable:function(e){$.ajax({url:"/users/usernames",method:"POST",data:{username:e},success:function(e,a){console.log("You got it ",e),RB.AUTH.appendMessage(e)},error:function(e){console.log("No you don't got it ",e)}})},registerLocalUser:function(){var e=$(".reg-un").val(),a=($(".reg-pw-2").val(),$(".social-strategy").data("id")),s=$(".social-data"),r=a.toString(),o={},i={};s.each(function(){var e=$(this).attr("data-key"),a=$(this).attr("data-"+e),s=e.toString();i[s]=a});var t=JSON.stringify(i);switch(o.username=e,o.password=e,o.strategy=r,r){case"facebook":o.facebook=t;break;case"facebook":o.twitter=t}$.ajax({type:"POST",url:"/users/",data:o,dataType:"JSON",success:function(e,a){console.log(e)},error:function(e){console.log(e),$(".reg-message").html(e.message)}})},appendMessage:function(e){switch($(".reg-icon").hide(),e.message){case"Available":$(".available").show(),RB.AUTH.usernameValidation=!0;break;case"Taken":$(".taken").show(),RB.AUTH.usernameValidation=!1}RB.AUTH.isValidated(),$(".reg-message").html(e.message)},isValidated:function(){RB.AUTH.usernameValidation===!0&&RB.AUTH.passwordValidation===!0?$(".reg-submit .fa").addClass("ready"):$(".reg-submit .fa").removeClass("ready")},comparePasswords:function(){var e=$(".reg-pw-2").val(),a=$(".reg-pw-1").val();e===a?($(".reg-notify .error").hide(),$(".reg-notify .ready").show(),RB.AUTH.passwordValidation=!0):""===e?($(".reg-notify .ready").hide(),$(".reg-notify .error").hide(),RB.AUTH.passwordValidation=!1):($(".reg-notify .ready").hide(),$(".reg-notify .error").show(),RB.AUTH.passwordValidation=!1),RB.AUTH.isValidated()}},$(document).on("ready",function(){RB.AUTH.init()});